package protocol

import (
	"encoding/hex"
	"testing"
)

func TestTask_UpdateBusy(t *testing.T) {
	midstate := []byte{0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff,
		0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00}
	task := NewTask(0x2a)
	task.Update(midstate)
	data, _ := task.MarshalBinary()
	if hex.EncodeToString(data) != "21362a0100000000ffffffffffffffffffffffff000000000000000000000000000000000000000"+
		"0000000000000000000000000860d" {
		t.Fail()
	}
}
